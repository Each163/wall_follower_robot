<?xml version="1.0" ?>
<!-- =================================================================================== -->
<!-- |    This document was autogenerated by xacro from two_wheeled_robot.urdf         | -->
<!-- |    EDITING THIS FILE BY HAND IS NOT RECOMMENDED                                 | -->
<!-- =================================================================================== -->
<!--
  Gazebo ROS differential drive plugin 

  Try sending commands:

    ros2 topic pub /demo/cmd_vel geometry_msgs/Twist '{linear: {x: 0.05}}' -1

    ros2 topic pub /demo/cmd_vel geometry_msgs/Twist '{angular: {z: 0.1}}' -1

  Try listening to odometry:

    ros2 topic echo /demo/odom

  Try listening to TF:

    ros2 run tf2_ros tf2_echo odom base_link

    ros2 run tf2_ros tf2_echo base_link right_wheel

    ros2 run tf2_ros tf2_echo base_link left_wheel
-->
<robot name="two_wheeled_robot_mine">
  <!-- If true, physics engine will ignore -->
  <gazebo>
    <static>false</static>
  </gazebo>
  <!-- ROBOT BASE FOORPRINT -->
  <!-- Define the center of the main robot chassis projected on the ground-->
  <!-- <link name="base_footprint"/>

    <joint name="base_joint" type="fixed">
        <parent link="base_footprint"/>
        <child link="base_link" />
        <origin xyz="0.0 0.0 ${(wheel_radius+wheel_zoff)}" rpy="0 0 0"/>
      </joint> -->
  <!-- ROBOT BASE -->
  <link name="base_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0.2"/>
      <geometry>
        <box size="0.49999999999999994 0.5 0.2"/>
      </geometry>
      <material name="Red">
        <color rgba="1.0 0.0 0.0 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0.2"/>
      <geometry>
        <box size="0.49999999999999994 0.5 0.2"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.5"/>
      <inertia ixx="0.02208333333333333" ixy="0.0" ixz="0.0" iyy="0.03083333333333333" iyz="0.0" izz="0.012083333333333335"/>
    </inertial>
  </link>
  <gazebo reference="base_link">
    <material>Gazebo/Red</material>
  </gazebo>
  <link name="drivewheel_l_link">
    <visual>
      <origin rpy="1.5707963267948966 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.05" radius="0.15"/>
      </geometry>
      <material name="White">
        <color rgba="1.0 1.0 1.0 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="1.5707963267948966 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.05" radius="0.15"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="1.5707963267948966 0 0" xyz="0 0 0"/>
      <mass value="0.1"/>
      <inertia ixx="0.0005833333333333333" ixy="0.0" ixz="0.0" iyy="0.0005833333333333333" iyz="0.0" izz="0.001125"/>
    </inertial>
  </link>
  <joint name="drivewheel_l_joint" type="revolute">
    <parent link="base_link"/>
    <child link="drivewheel_l_link"/>
    <origin rpy="0 0 0" xyz="-0.2 -0.3 0.2"/>
    <limit effort="30" lower="-3.141592653589793" upper="3.141592653589793" velocity="5.0"/>
    <axis xyz="0 1 0"/>
  </joint>
  <gazebo reference="drivewheel_l_link">
    <material>Gazebo/White</material>
  </gazebo>
  <link name="drivewheel_r_link">
    <visual>
      <origin rpy="1.5707963267948966 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.05" radius="0.15"/>
      </geometry>
      <material name="White">
        <color rgba="1.0 1.0 1.0 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="1.5707963267948966 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.05" radius="0.15"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="1.5707963267948966 0 0" xyz="0 0 0"/>
      <mass value="0.1"/>
      <inertia ixx="0.0005833333333333333" ixy="0.0" ixz="0.0" iyy="0.0005833333333333333" iyz="0.0" izz="0.001125"/>
    </inertial>
  </link>
  <joint name="drivewheel_r_joint" type="revolute">
    <parent link="base_link"/>
    <child link="drivewheel_r_link"/>
    <origin rpy="0 0 0" xyz="-0.2 0.3 0.2"/>
    <limit effort="30" lower="-3.141592653589793" upper="3.141592653589793" velocity="5.0"/>
    <axis xyz="0 1 0"/>
  </joint>
  <gazebo reference="drivewheel_r_link">
    <material>Gazebo/White</material>
  </gazebo>
  <link name="front_sphere">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <!-- <sphere radius="${front_sphere_radius}"/> -->
        <sphere radius="0.025"/>
      </geometry>
      <material name="White">
        <color rgba="1.0 1.0 1.0 1.0"/>
      </material>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <sphere radius="0.024999999999999994"/>
      </geometry>
    </collision>
    <inertial>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <mass value="0.1"/>
      <inertia ixx="2.499999999999999e-05" ixy="0.0" ixz="0.0" iyy="2.499999999999999e-05" iyz="0.0" izz="2.499999999999999e-05"/>
    </inertial>
  </link>
  <joint name="front_sphere_joint" type="fixed">
    <parent link="base_link"/>
    <child link="front_sphere"/>
    <origin rpy="0 0 0" xyz="0.225 0 0.075"/>
  </joint>
  <!-- IMU SETUP -->
  <link name="imu_link"/>
  <joint name="imu_joint" type="fixed">
    <parent link="base_link"/>
    <child link="imu_link"/>
    <origin rpy="0 0 0" xyz="0.1 0 0.1"/>
  </joint>
  <!-- LIDAR SETUP -->
  <link name="lidar_link">
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.05" radius="0.0508"/>
      </geometry>
      <material name="Black">
        <color rgba="0.0 0.0 0.0 1"/>
      </material>
    </visual>
    <collision>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <geometry>
        <cylinder length="0.05" radius="0.0508"/>
      </geometry>
    </collision>
    <inertial>
      <mass value="0.1"/>
      <origin rpy="0 0 0" xyz="0 0 0"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
    </inertial>
  </link>
  <joint name="lidar_joint" type="fixed">
    <parent link="base_link"/>
    <child link="lidar_link"/>
    <origin rpy="0 0 0" xyz="0.3 0 0.30000000000000004"/>
  </joint>
  <gazebo reference="lidar_link">
    <sensor name="laser" type="ray">
      <ray>
        <scan>
          <horizontal>
            <samples>181</samples>
            <resolution>1</resolution>
            <min_angle>-1.5707963267948966</min_angle>
            <max_angle>1.5707963267948966</max_angle>
          </horizontal>
        </scan>
        <range>
          <min>0.08</min>
          <max>10</max>
          <resolution>0.05</resolution>
        </range>
      </ray>
      <always_on>1</always_on>
      <update_rate>10</update_rate>
      <visualize>true</visualize>
      <plugin filename="libgazebo_ros_ray_sensor.so" name="laser">
        <ros>
          <namespace>/demo</namespace>
          <argument>--ros-args --remap ~/out:=scan</argument>
        </ros>
        <output_type>sensor_msgs/LaserScan</output_type>
        <!-- <updateRate>50</updateRate>
                <topicName>laser_frame</topicName> -->
      </plugin>
    </sensor>
  </gazebo>
  <gazebo>
    <plugin filename="libgazebo_ros_diff_drive.so" name="diff_drive">
      <ros>
        <namespace>/demo</namespace>
        <remapping>cmd_vel:=cmd_vel</remapping>
        <remapping>odom:=odom</remapping>
      </ros>
      <updata_rate>30</updata_rate>
      <!-- wheels -->
      <left_joint>drivewheel_l_joint</left_joint>
      <right_joint>drivewheel_r_joint</right_joint>
      <!-- kinematics -->
      <wheel_separation>0.65</wheel_separation>
      <wheel_diameter>0.3</wheel_diameter>
      <!-- limits -->
      <max_wheel_torque>3</max_wheel_torque>
      <max_wheel_acceleration>1.0</max_wheel_acceleration>
      <!-- output -->
      <publish_odom>true</publish_odom>
      <publish_odom_tf>true</publish_odom_tf>
      <publish_wheel_tf>true</publish_wheel_tf>
      <odometry_frame>odom</odometry_frame>
      <robot_base_frame>base_link</robot_base_frame>
    </plugin>
  </gazebo>
</robot>
